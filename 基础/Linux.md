## Linux

### Linux 简介

+ 类Unix系统：Linux 是一种自由、开放源码的类似Unix的操作系统
+ Linux内核：严格来说，Linux 这个词本身只表示Linux内核
+ Linux之父：一位编程领域的传奇式人物。是Linux 内核的最早作者，还发起了Git这个开源项目。

### Linux 诞生

- 1991年，芬兰的业余计算机爱好者Linus Torvalds编写了一款类似Minix的系统（基于微内核架构的类Unix操作系统）被ftp管理员命名为Linux 加入到自由软件基金的GNU计划中;
- Linux以一只可爱的企鹅作为标志，象征着敢作敢为、热爱生活。

### Linux 的分类

Linux根据原生程度，分为两种：

1. 内核版本：Linux不是一个操作系统，严格来说，Linux只是一个操作系统的内核。内核建立了计算机软件和硬件之间通讯的平台，内核提高系统服务，如文件管理，虚拟内存，设备I/O等
2. 发行版本：一些组织或公司在内核版本的基础上进行二次开发而重新发现的版本。Linux发行的版本有很多（ubuntu、centos、redhat、debian等等）

## Linux文件系统概述

### 文件系统简介

**在 Linux 操作系统中，所有被操作系统管理的资源，例如网络接口卡、磁盘驱动器、打印机、输入输出设备、普通文件或是目录都被看作是一个文件**

也就是说Linux系统中有一个重要的概念：一切都是文件。其实这是UNIX哲学的一个体现

UNIX系统把每个硬件都看成一个文件，通常称之为设备文件，通过读写文件实现对硬件的访问

### Inode

inode是linux/unix文件系统和硬盘存储的基础

文件存储在硬盘上，硬盘的最小存储单位是扇区（Sector）

每个扇区存储512字节（0.5kb）

操作系统读取硬盘的数据时，不会一个扇区一个扇区的读取，这样的效率很低

**而是一次读取多个扇区，即一次读取一个快（block）**

**块由多个扇区组成，是文件读取的最小单位，块的最常见的大小是4kb，约为8个连续的扇区组成**

文件数据存储在块中，但还需要一个空间来存储文件的元信息metdata，如文件拥有者，创建时间，权限，大小等。

**这种存储文件元信息的区域就叫做inode，译为索引节点**

每个文件都有一个inode，存储文件的元信息。使用stat命令可以查看文件的inode信息

**每个inode都有一个号码，Linux/Unix操作系统不使用文件名来区分文件，而是使用inode号区分不同的文件**

inode也需要消耗硬盘空间，所以在格式化硬盘的时候，操作系统会将硬盘分为两个区域，一个区域存放文件数据，另一个区域存放inode所包含的信息，存放inode的区域被称作inode table

### 文件类型与目录结构

Linux 支持很多文件类型，其中非常重要的文件类型有：普通文件，目录文件，链接文件，设备文件，管道文件，Socket套接字文件

![image-20200806135707836](D:/Photo/Typora/image-20200806135707836.png)

链接文件：链接文件分为符号链接（软链接）文件和硬链接文件

+ 硬链接（Hard Link）：硬链接的文件拥有相同的inode，因为操作系统是靠inode来区分文件的，2个inode相同的文件，就代表它们是同一个文件。**删除一个文件并不会对其他拥有相同inode的文件产生影响**，只有当inode相同的所有文件被删除了， 这个文件才会被删除。换言之，你建立一个文件的硬链接，这个文件和硬链接它们的inode是相同的, 无论你删除的是硬链接还是源文件，都不会对彼此造成影响,**除非你把硬链接和源文件都删除， 这个文件才被删除。**
+ 符号链接（软链接）（Symbolic Link）：符号链接类似于windows上的快捷方式，他保存了源文件的路径，当符号链接被删除时，并不会影响源文件。当原文件被删除是，符号链接就找不到源文件了。

设备文件：设备文件分为块设备文件和字符设备文件，设备文件一般存于/dev目录下

+ 字符设备文件：字符设备是依照先后顺序被存取数据的设备，通常不支持随机存取，此类设备可以按照字节/字符来读取数据，如键盘，串口等
+ 块设备文件：块设备是可以被随机存取数据的设备，应用程序可以访问块设备上的任何一块位置。块设备以块的方式读取数据，在windows下也称为簇，块设备不支持字符的方式寻址。如硬盘，软盘，光碟等等。

字符设备和块设备的最根本区别就是它们是否可以被随机访问。如键盘，当我们在键盘上敲下一个单词：“word”时，那么系统肯定需要按照顺序来读取word的字节流（字符流）的，随机访问在此时就没有意义了

管道文件：管道文件一般用于进程间的通信，使用mkfifo命令可以创建一个管道文件

Socket套接字文件：套接字文件被用于网络进程间的通信，即可以使两台不同的机器进行通信，也可以用于本机的Socket网络通信

### Linux目录树

所有可操作的计算机资源都存在于目录树这个结构中，对计算机资源的访问，可以看作是对这目录树的访问。

#### Linux的目录结构如下：

Linux文件系统的结构层次鲜明，就像一颗倒立的树，最顶层是其根目录

![image-20200806142712941](D:/Photo/Typora/image-20200806142712941.png)

#### 常见目录说明

+ /bin：存放二进制可执行文件（ls、cat、mkdir等），常见命令一般都在这里
+ /etc：存放系统管理和配置文件
+ /home：存放所有用户文件的根目录，是用户主目录的基点，如用户user的主目录就是/home/user
+ /usr：用于存放系统应用程序
+ /opt：额外安装的可选应用程序包所放置的位置，一般，可以把tomcat等都安装在这里
+ /proc：虚拟文件系统目录，是系统内存的映射。可直接访问这个目录来获取系统信息
+ /root：超级用户（系统管理员）的主目录（特权）
+ /sbin：存放二进制可执行文件，只有root才能访问
+ /dev：用于存放设备文件
+ /boot：存放用于系统引导时使用的各种文件
+ /mnt：系统管理员安装临时文件系统的安装点。可让用户临时挂在其他文件系统
+ /lib：存放着和系统运行相关的库文件
+ /tmp：用于存放各种临时文件，是公用的临时文件存储点
+ /var：用于存放运行时需要改变数据的大文件，也是某些大文件的溢出区，不如各种服务的日志等
+ /lost+found：这个目录平时是空的，系统非正常关机而留下“无家可归”的文件

## Linux基本命令

### 目录切换命令

+ cd usr ：切换到该目录下的usr目录
+ cd ..（或cd ../）：切换到上一层目录
+ cd /：切换到系统根目录
+ cd ~：切换到用户主目录
+ cd -：切换到上一个操作所在的目录

### 目录的操作目录（增删改查）

1. mkdir 目录名称：增加目录
2. ls 或者 ll （ll是 ls -l的别名，ll命令可以看到该目录下的所有目录和文件的详细信息）:查看目录信息
3. find 目录 参数：寻找目录（查）
4. mv 目录名称 新目录名称：修改目录的名称（改）
5. mv 目录名称 目录的新位置：移动目录的位置---剪切（改）
6. cp -r 目录名称 目录拷贝的目标位置：拷贝目录（改），-r代表递归拷贝
7. rm [-rf] 目录：删除目录（删）
8. ln 【参数】 源文件 目标链接  链接目录或文件，-b参数，删除，-d参数，建立硬链接，-s参数，建立软连接

### 文件的操作命令（增删改查）

1. touch 文件名称：文件的创建（增）
2. cat/more/less/tail 文件名称：文件的查看（查）
   + cat：查看显示文件内容
   + more：可以显示百分比，回车可以向下一行，空格可以向下一页，q可以退出查看
   + less：可以使用键盘上的pgUp和pgDn向上和向下翻页，q结束查看
   + tail -10：查看文件的后10行，Crtl+C结束
3. vim 文件：修改文件的内容 （改）
4. rm -rf 文件：删除文件（删）

### 压缩文件的操作命令

![image-20200806145936588](D:/Photo/Typora/image-20200806145936588.png)

### Linux的权限命令

操作系统中的每个文件都拥有特定的权限、所属用户和所属组。权限是操作系统用来限制资源访问的机制。在Linux中权限一般分为读（readable）、写（writable）和执行（excutable），分三组。分别对应文件的属主（owner），属组（group）和其他用户（other），通过这样的机制来限制哪些用户，那些组可以对特定的文件进行什么样的操作。通过ls -l命令我们可以 查看某个目录下的文件或目录的权限

![image-20200806150551798](D:/Photo/Typora/image-20200806150551798.png)

#### 文件的类型

+ d：代表目录
+ -：代表文件
+ l：代表软连接

#### Linux下权限分以下几种：

+ r：代表权限是可读，r也可以用数字4表示
+ w：代表权限是可写，w也可以用数字2表示
+ x：代表权限是可执行，x也可以用数字1表示

#### 文件和目录权限的区别

对于文件：

r：可以使用cat查看文件的内容

w：可以修改文件的内容

x：可以将其运行为二进制文件

对于目录：

r：可以查看目录下列表

w：可以创建和删除目录下文件

x：可以使用cd进入目录

**需要注意的是，超级用户可以无视普通用户的权限，即使文件权限是000，依旧可以访问。在Linux中每个用户必须属于一个组，不能独立于组外。哎Linux中每个文件有所有者，所有组，其他组的概念**

+ 所有者

  一般为文件的创建者，谁创建了该文件，就天然的成为该文件的所有者，用**ls -ahl**命令可以看到文件的所有者，也可以使用**chown 用户名 文件名**来修改文件的所有者

+ 文件所在组

  当某个用户创建一个文件后，这个文件的所有组就是该用户所在的组，用**ls ahl** 命令可以查看文件的所有组，也可以使用**chgrp 组名 文件名**来修改文件的所在组

+ 其他组

  除开文件的所有者和所有组的用户外，系统的其他用户都是文件的其他组

修改文件/目录的权限的命令：**chmod**

![image-20200806152017617](D:/Photo/Typora/image-20200806152017617.png)

### Linux用户管理

Linux系统是一个多用户多任务的分时操作系统，任何一个要使用系统资源的用户，都必须先向系统管理员申请一个账号，然后以这个账号的身份进入系统

用户的账号一方面可以帮助系统管理员对使用系统的用户进行跟踪，并控制它们对系统资源的访问，另一方面可以帮助用户组织文件，并为用户提供安全性保护

#### 用户管理相关命令

- `useradd 选项 用户名`:添加用户账号
- `userdel 选项 用户名`:删除用户帐号
- `usermod 选项 用户名`:修改帐号
- `passwd 用户名`:更改或创建用户的密码
- `passwd -S 用户名` :显示用户账号密码信息
- `passwd -d 用户名`: 清除用户密码

useradd命令用于Linux中创建的新的系统用户。useradd可用来建立用户帐号。帐号建好之后，再用passwd设定帐号的密码．而可用userdel删除帐号。使用useradd指令所建立的帐号，实际上是保存在/etc/passwd文本文件中。

passwd命令用于设置用户的认证信息，包括用户密码、密码过期时间等。系统管理者则能用它管理系统用户的密码。只有管理者可以指定用户名称，一般用户只能变更自己的密码。

### Linux系统用户组的管理

每个用户都有一个用户组，系统可以对一个用户组中的所有用户进行集中管理。

用户组的管理涉及用户组的添加、删除和修改。这实际上是对/etc/group文件的更新

**Linux系统用户组的管理相关命令:**

- `groupadd 选项 用户组` :增加一个新的用户组
- `groupdel 用户组`:要删除一个已有的用户组
- `groupmod 选项 用户组` : 修改用户组的属性

### 其他命令

![image-20200806152836227](D:/Photo/Typora/image-20200806152836227.png)

#### 开机关机

```xml
sync # 将数据由内存同步到硬盘中（一般在关机命令前使用）
shutdown # 关机命令，可以使用man shutdown 来看文档说明
shutdown -h 10/now/20：25/+10 关机的延迟时间
shutdown -r now/+10 系统重启
reboot # 重启
helt # 关闭系统
```

### 环境安装

rpm

解压缩

yum在线安装

#### JDK安装

1. 下载JDK rpm
2. 安装java环境

```xml
# 检查当前系统中是否存在java环境 java -version
# 如果有的话就需要卸载
# rpm -qa | grep jdk  # 检查jdk版本信息
# rpm -e --nodeps jdk_

# 卸载完后就可以安装jdk
# rpm -ivk rpm包

# 配置环境变量
vim /etc/profile
JAVA_HOME=/usr/java/jdk1.8.0_261-amd64
CLASSPATH=%JAVA_HOME%/lib;%JAVA_HOME%/jre/lib
PATH=$JAVA_HOME/bin;$JAVA_HOME/jre/bin
export PATH CLASSPATH JAVA_HOME
```

防火墙相关操作

```bash
# 查看firewall服务状态
systemctl status firewalld

# 开启、重启、关闭firewalld.service服务
# 开启
service firewalld start
# 重启
service firewalld restart
# 关闭
service firewalld stop

# 查看防火墙规则
firewall-cmd --list-all  # 查看全部信息
firewall-cmd --list-ports # 只看端口信息
# 开启端口
firewall-cmd --zone=public --add-port=8080/tcp --permanent
# 重启防火墙
systemctl restart firewalld.service
```





# Shell

## 初探 Shell

### 为什么学 Shell

目前Linux系统下做流行的运维自动化语言就是Shell和Python了

Shell几乎是IT企业必须使用的运维化编程语言，特别是在运维工作中的服务监控，业务快速部署，服务停止启动，数据备份及处理，日志分析等，shell不可缺少。

Python 更适合处理复杂的业务逻辑，以及开发复杂的运维软件工具，实现we访问等

Shell 是一个命令解释器，解释执行用户所输入的命令和程序。

### Shell

Shell编程就是对一堆Linux命令的逻辑化处理

### 编程 Hello Word

![image-20200807143912129](D:/Photo/Typora/image-20200807143912129.png)

## Shell 变量

### 变量介绍

**shell编程中一般分为三种变量：**

+ 我们自己定义的变量（自定义变量）：仅在当前Shell 实例中有效，其他 Shell 启动的程序不能访问局部变量
+ Linux已定义的环境变量（环境变量，例如：$PATH,$HOME。。这类变量我们可以直接使用），使用 `env`命令可以查看所有的环境变量，而set命令既可以查看环境变量也可以查看自定义变量
+ Shell变量：Shell变量是由Shell程序设置的特殊变量。Shell变量中一部分是环境变量，一部分是局部变量，这些变量保证了Shell的正常运行

**常用的环境变量**

PATH 决定了shell将到哪些目录中寻找命令或程序

HOME 当前用户主目录

HISTSIZE 历史记录数

LOGNAME 当前用户的登录名

HOSTNAME 指主机的名称

SHELL 当前用户的Shell类型

LANGUGE 语言相关的环境变量，多语言可以修改此环境变量

MAIL 当前用户的邮件存放目录

PS1 基本提示符，对于root用户是#，对于普通用户是$

**使用Linux已定义的环境变量**

若要看当前用户目录可以使用：echo $HOME 命令，等等

**使用自己定义的变量**

```shell
#!/bin/bash
#自定义变量hello
hello="hello world"
echo $hello
echo  "helloworld!"
```

**Shell 编程中变量名的命名注意事项**

+ 命名只能使用英文字母，数字和下划线
+ 中间不能有空格
+ 不能使用标点符号
+ 不能使用bash关键字

### Shell 字符串

字符串可以用单引号，也可以使用双引号

#### shell 字符串常见操作

**拼接字符串**

![image-20200807150245039](D:/Photo/Typora/image-20200807150245039.png)

**获取字符串长度**

![image-20200807150415786](D:/Photo/Typora/image-20200807150415786.png)

**截取字符串**

简单的字符串截取：

```shell
#从字符串第 1 个字符开始往后截取 10 个字符
str="SnailClimb is a great man"
echo ${str:0:10} #输出:SnailClimb
```

根据表达式截取：

```shell
#!bin/bash
#author:amau

var="http://www.runoob.com/linux/linux-shell-variable.html"

s1=${var%%t*}#h
s2=${var%t*}#http://www.runoob.com/linux/linux-shell-variable.h
s3=${var%%.*}#http://www
s4=${var#*/}#/www.runoob.com/linux/linu
```

### Shell 数组

bash 支持一维数组（不支持多维数组），并且没有限定数组的大小。实例如下：

```shell
#!/bin/bash
array=(1 2 3 4 5);
# 获取数组长度
length=${#array[@]}
# 或者
length2=${#array[*]}
#输出数组长度
echo $length #输出：5
echo $length2 #输出：5
# 输出数组第三个元素
echo ${array[2]} #输出：3
unset array[1]# 删除下标为1的元素也就是删除第二个元素
for i in ${array[@]};do echo $i ;done # 遍历数组，输出： 1 3 4 5 
unset arr_number; # 删除数组中的所有元素
for i in ${array[@]};do echo $i ;done # 遍历数组，数组元素为空，没有任何输出内容
```

## Shell 基本运算符

### 算数运算符

+

-

*

/

%

=

==

！=

### 关系运算符

![image-20200807150954692](D:/Photo/Typora/image-20200807150954692.png)

### 逻辑运算符

$$

||

### 布尔运算符

！非

-o 或

-a 与

### 字符串运算符

==

！=

-z 字符串长度是否为0

str 检测字符串是否为空

### 文件相关运算符

![image-20200807151248055](D:/Photo/Typora/image-20200807151248055.png)

## Shell 流程控制

### if 条件语句

if else-if else 

```shell
#!/bin/bash
a=3;
b=9;
if [ $a -eq $b ]
then
   echo "a 等于 b"
elif [ $a -gt $b ]
then
   echo "a 大于 b"
else
   echo "a 小于 b"
fi
```

### for 循环语句

```shell
for loop in 1 2 3 4 5
do
    echo "The value is: $loop"
done
```

### while 语句

```shell
#!/bin/bash
int=1
while(( $int<=5 ))
do
    echo $int
    let "int++"
done
```

**while循环可用于读取键盘信息：**

```shell
echo '按下 <CTRL-D> 退出'
echo -n '输入你最喜欢的电影: '
while read FILM
do
    echo "是的！$FILM 是一个好电影"
done
```

输出内容:

```
按下 <CTRL-D> 退出
输入你最喜欢的电影: 变形金刚
是的！变形金刚 是一个好电影
```

## Shell 函数

### 不带参数没有返回值的函数

```shell
#!/bin/bash
hello(){
    echo "这是我的第一个 shell 函数!"
}
echo "-----函数开始执行-----"
hello
echo "-----函数执行完毕-----"
```

输出结果：

```shell
-----函数开始执行-----
这是我的第一个 shell 函数!
-----函数执行完毕-----
```

### 有返回值的函数

**输入两个数字之后相加并返回结果：**

```shell
#!/bin/bash
funWithReturn(){
    echo "输入第一个数字: "
    read aNum
    echo "输入第二个数字: "
    read anotherNum
    echo "两个数字分别为 $aNum 和 $anotherNum !"
    return $(($aNum+$anotherNum))
}
funWithReturn
echo "输入的两个数字之和为 $?"
```

输出结果：

```shell
输入第一个数字: 
1
输入第二个数字: 
2
两个数字分别为 1 和 2 !
输入的两个数字之和为 3
```

### 有参数的函数

```shell
#!/bin/bash
funWithParam(){
    echo "第一个参数为 $1 !"
    echo "第二个参数为 $2 !"
    echo "第十个参数为 $10 !"
    echo "第十个参数为 ${10} !"
    echo "第十一个参数为 ${11} !"
    echo "参数总数有 $# 个!"
    echo "作为一个字符串输出所有参数 $* !"
}
funWithParam 1 2 3 4 5 6 7 8 9 34 73
```

输出结果：

```shell
第一个参数为 1 !
第二个参数为 2 !
第十个参数为 10 !
第十个参数为 34 !
第十一个参数为 73 !
参数总数有 11 个!
作为一个字符串输出所有参数 1 2 3 4 5 6 7 8 9 34 73 !
```
